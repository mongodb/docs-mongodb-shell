.. _mdb-shell-connect:

=======================
Connect to a Deployment
=======================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 2
   :class: singlecol

This page shows how to use the |mdb-shell| to connect to a MongoDB
deployment.

Prerequisites
-------------

.. include:: /includes/fact-connect-prereqs.rst
   

Local Deployment on Default Port
--------------------------------

To connect to a MongoDB deployment running on **localhost** with
**default port** 27017, run ``mongosh`` without any options:

.. code-block:: sh

   mongosh

This is equivalent to the following command:

.. code-block:: sh

   mongosh "mongodb://localhost:27017"

Local Deployment on a Non-Default Port
--------------------------------------

To specify a port to connect to on localhost, you can use either:

- A :manual:`connection string </reference/connection-string>`.

- The ``--port`` command-line option.

For example, the following commands connect to a deployment running on
localhost port 28015:

.. code-block:: sh

   mongosh "mongodb://localhost:28015"

.. code-block:: sh

   mongosh --port 28015

MongoDB Deployment on a Remote Host
-----------------------------------

To specify a remote host and port, you can use either:

- A :manual:`connection string </reference/connection-string>`.

- The ``--host`` and ``--port`` command-line options. If you do not
  include the ``--port`` option, ``mongosh`` uses the default port
  27017.

For example, the following commands connect to a MongoDB deployment
running on host ``mongodb0.example.com`` and port 28015:

.. code-block:: sh

   mongosh "mongodb://mongodb0.example.com:28015"

.. code-block:: sh

   mongosh --host mongodb0.example.com --port 28015

.. note:: Connect to |service-fullname|

   If your remote host is a |service| cluster, you can copy your
   connection string from the |service| UI. To learn more, see
   :atlas:`Connect to a Cluster
   </connect-to-cluster/#use-the-connect-dialog-to-connect-to-your-cluster>`
   in the Atlas documentation.

Connection Options
------------------

Specify different connection options to connect to different types of
deployments.

Connect With Authentication
~~~~~~~~~~~~~~~~~~~~~~~~~~~

To connect to a MongoDB deployment requires authentication, use the
:option:`--username <--username>` and :option:`--authenticationDatabase
<--authenticationDatabase>` options. ``mongosh`` prompts you for a
password, which it hides as you type.

For example, run the following command to authenticate on the ``admin``
database as user ``alice``:

.. code-block:: sh

   mongosh "mongodb://mongodb0.example.com:28015" --username alice --authenticationDatabase admin

.. seealso::

   - To enforce authentication on a deployment, see
     :manual:`Enable Access Control </tutorial/enable-authentication/>`.

   - To provision access to a MongoDB deployment, see :manual:`Database
     Users </core/security-users/>`.

Connect to a Replica Set
~~~~~~~~~~~~~~~~~~~~~~~~

To connect to a replica set, perform one of the following actions:

- If you use the :manual:`DNS Seedlist Connection Format
  </reference/connection-string/#dns-seedlist-connection-format>`,include
  the ``+srv`` modifier in your connection string.

  For example, run the following command to connect to a replica set on
  ``server.example.com``:

  .. code-block:: sh

     mongosh "mongodb+srv://server.example.com/"

  .. note:: +srv TLS Behavior

     When you use the ``+srv`` connection string modifier, MongoDB
     automatically sets the :option:`--tls <--tls>` connection option to
     ``true``. To override this behavior, set ``--tls`` to ``false``.

- You can specify the replica set name and members in the
  :manual:`connection string </reference/connection-string>`.

  For example, run the following command to connect to a three-member
  replica set named ``replA``:

  .. code-block:: sh

     mongosh "mongodb://mongodb0.example.com.local:27017,mongodb1.example.com.local:27017,mongodb2.example.com.local:27017/?replicaSet=replA"

.. note:: directConnection Parameter

   ``mongosh`` adds the ``directConnection=true`` query parameter to the
   connection string automatically unless at least one of the following is
   true:

   - The ``replicaSet`` query parameter is present in the connection string.
   - The connection string uses the ``mongodb+srv://`` scheme.
   - The connection string contains a seed list with multiple hosts.

   When ``directConnection=true``, all operations are run on the host
   specified in the connection URI.

Connect Using TLS
~~~~~~~~~~~~~~~~~

To connect to a deployment using TLS, perform one of the following
actions:

- Use the :manual:`DNS Seedlist Connection Format
  </reference/connection-string/#dns-seedlist-connection-format>`. The
  ``+srv`` connection string modifier automatically sets the ``tls``
  option to ``true`` for the connection.

  For example, run the following command to connect to a DNS
  seedlist-defined replica set with ``tls`` enabled:

  .. code-block:: sh

     mongosh "mongodb+srv://server.example.com/"

- Specify the :option:`--tls <--tls>` option to ``true`` in the connection
  string.

  For example, run the following command to enable ``tls`` with a
  connection string option:

  .. code-block:: sh

     mongosh "mongodb://mongodb0.example.com:28015/?tls=true"

- Specify the ``--tls`` command-line option.

  For example, run the following command to connect to a remote host
  with ``tls`` enabled:

  .. code-block:: sh

     mongosh "mongodb://mongodb0.example.com:28015" --tls

Connect to a Specific Database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To connect to a specific database, specify a database in your
:manual:`connection string URI path </reference/connection-string/>` If
you do not specify a database in your URI path, you connect to the
``test`` database.

For example, run the following command to connect to a database called
``qa`` on localhost:

.. code-block:: sh

    mongosh "mongodb://localhost:27017/qa" 

Connect to a Different Deployment
---------------------------------

If you are already connected to a deployment in the |mdb-shell|, you can
use the :method:`Mongo()` or :manual:`connect()
</reference/method/connect/>` method to connect to a different MongoDB
deployment from within the |mdb-shell|.

To learn how to connect to a different deployment using these methods,
see :ref:`mdb-shell-open-new-connections-in-shell`.

Verify Current Connection
-------------------------

To verify your current database connection, use the
:method:`db.getMongo()` method.

The method returns the :manual:`connection string URI
</reference/connection-string/>` for your current connection.

Disconnect from a Deployment
----------------------------

To disconnect from a deployment and exit ``mongosh``, perform one of the
following actions:

- Type ``.exit``, ``exit``, or ``exit()``.

- Type ``quit`` or ``quit()``.

- Press ``Ctrl`` + ``D``.

- Press ``Ctrl`` + ``C`` twice.

Limitations
-----------

- :manual:`Kerberos authentication </core/kerberos/>` does not allow
  ``authMechanismProperties=CANONICALIZE_HOST_NAME:true|false`` in the
  connection string. Instead, use either:
  
  - ``authMechanismProperties=CANONICALIZE_HOST_NAME:forward``
  - ``authMechanismProperties=CANONICALIZE_HOST_NAME:forwardAndReverse``
  - ``authMechanismProperties=CANONICALIZE_HOST_NAME:none``

- ``mongosh`` currently only supports the ``zlib``
  :manual:`compressor </core/wiredtiger/#compression>`. The following 
  compressors are not supported:

  - ``zstd``
  - ``snappy``
